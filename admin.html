<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard - Seller</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.talkjs.com/talk.js"></script>
<style>
body {
    margin:0;
    font-family:'Segoe UI', sans-serif;
    background: linear-gradient(135deg,#0f1115,#1a1c25);
    color:#fff;
    min-height:100vh;
    padding:20px;
}
h1{color:#00ff9c;text-align:center;margin-bottom:20px;}
.login-container, .dashboard-container{
    max-width:500px;
    margin:auto;
    background:#1c1e2a;
    padding:30px;
    border-radius:20px;
    box-shadow:0 0 20px #00ff9c;
}
input{
    width:100%;
    padding:10px;
    margin:10px 0;
    border-radius:10px;
    border:none;
}
button{
    width:100%;
    padding:12px;
    border:none;
    border-radius:10px;
    font-weight:bold;
    cursor:pointer;
    transition:0.3s;
}
button:hover{opacity:0.85;}
#logoutBtn{
    background:#ff4444;
    color:#fff;
    margin-bottom:10px;
}
#clearBtn{
    background:#00aaff;
    color:#fff;
    margin-bottom:20px;
}
#inboxContainer{
    width:100%;
    height:600px;
    border-radius:12px;
    overflow:hidden;
}
</style>
</head>
<body>

<!-- ADMIN LOGIN -->
<div class="login-container" id="loginPage">
<h1>Admin Login</h1>
<input type="email" id="adminEmail" placeholder="Email">
<input type="password" id="adminPass" placeholder="Password">
<button id="loginBtn">Login</button>
<p id="loginError" style="color:red;text-align:center;margin-top:10px;"></p>
</div>

<!-- DASHBOARD -->
<div class="dashboard-container" id="dashboardPage" style="display:none;">
<h1>Admin Dashboard - Seller</h1>
<button id="logoutBtn">Logout</button>
<button id="clearBtn">Clear Inbox</button>
<div id="inboxContainer"></div>
</div>

<script>
const adminEmail = "cunninghamkirbycun@gmail.com";
const adminPass = "kirbycunningham#10";

const loginPage = document.getElementById("loginPage");
const dashboardPage = document.getElementById("dashboardPage");
const loginBtn = document.getElementById("loginBtn");
const loginError = document.getElementById("loginError");
const logoutBtn = document.getElementById("logoutBtn");
const clearBtn = document.getElementById("clearBtn");
const inboxContainer = document.getElementById("inboxContainer");

const talkjsAppId = "tRkW5nYP";
let session;
let inbox;

loginBtn.addEventListener("click", async () => {
    const email = document.getElementById("adminEmail").value;
    const pass = document.getElementById("adminPass").value;

    if(email===adminEmail && pass===adminPass){
        loginPage.style.display = "none";
        dashboardPage.style.display = "block";

        await Talk.ready;

        // Admin logs in as the seller
        const me = new Talk.User({
            id: "seller",      // seller ID
            name: "Seller",
            email: adminEmail,
            photoUrl: "https://i.imgur.com/0F9Z4.png"
        });

        session = new Talk.Session({
            appId: talkjsAppId,
            me: me,
            notify: true
        });

        // Show inbox with all buyer conversations
        inbox = session.createInbox({ selected: null });
        inbox.mount(inboxContainer);

    } else {
        loginError.textContent = "Invalid email or password!";
    }
});

logoutBtn.addEventListener("click", ()=>{
    dashboardPage.style.display="none";
    loginPage.style.display="block";
    inboxContainer.innerHTML="";
});

// Clear inbox temporarily (hide it without destroying)
clearBtn.addEventListener("click", ()=>{
    // Instead of removing DOM, just hide the container
    inboxContainer.style.display = "none";
});

// Automatically show inbox again if a new message arrives
if (typeof Talk !== "undefined") {
    Talk.ready.then(() => {
        if (session) {
            session.on("message", () => {
                inboxContainer.style.display = "block";
            });
        }
    });
}
</script>

</body>
</html>

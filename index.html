<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TalkJS Chat Test</title>
  <script src="https://cdn.talkjs.com/talk.js"></script>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      background-color: #000; /* Black background */
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: Arial, sans-serif;
    }

    #open-chat {
      width: 120px;
      height: 120px;
      background-color: #00ff00; /* Bright green */
      border: none;
      border-radius: 50%; /* Circle */
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      color: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: transform 0.2s;
    }

    #open-chat:hover {
      transform: scale(1.1);
    }

    #talkjs-container {
      width: 100%;
      height: 100vh;
      display: none; /* Hidden until button is clicked */
    }
  </style>
</head>
<body>

  <button id="open-chat">Open Chat</button>
  <div id="talkjs-container"></div>

  <script>
    let session;
    let conversation;

    // Wait for TalkJS SDK to load
    Talk.ready.then(() => {
      console.log("TalkJS loaded");

      // Define users
      const personOne = new Talk.User({
        id: "person1",
        name: "Person One",
        email: "person1@example.com",
        photoUrl: "https://randomuser.me/api/portraits/lego/1.jpg",
        welcomeMessage: "Hello! I'm Person One."
      });

      const personTwo = new Talk.User({
        id: "person2",
        name: "Person Two",
        email: "person2@example.com",
        photoUrl: "https://randomuser.me/api/portraits/lego/2.jpg",
        welcomeMessage: "Hi! I'm Person Two."
      });

      // Create TalkJS session
      session = new Talk.Session({
        appId: "tUlq8yXw", // Your App ID
        me: personOne
      });

      // Create one-on-one conversation
      conversation = session.getOrCreateConversation(Talk.oneOnOneId(personOne, personTwo));
      conversation.setParticipant(personOne);
      conversation.setParticipant(personTwo);

      // Mount inbox but keep hidden
      const inbox = session.createInbox({ selected: conversation });
      inbox.mount(document.getElementById("talkjs-container"));

      console.log("TalkJS session and conversation ready");
    }).catch(e => console.error("TalkJS failed to load:", e));

    // Button opens the chat
    document.getElementById("open-chat").addEventListener("click", () => {
      document.getElementById("talkjs-container").style.display = "block";
      document.getElementById("open-chat").style.display = "none";
      console.log("Chat opened");
    });
  </script>

</body>
</html>
